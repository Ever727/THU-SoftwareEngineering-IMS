## 模块

### 前端模块

前端主要由**首页模块**、**注册模块**、**登录模块**、**个人信息模块**、**聊天模块**、**默认模块**构成，有相应路由。其余模块内嵌于上述模块，分别为**头像模块**、**聊天窗口模块**、**会话选择模块**、**历史消息模块**、**主页模块**、**导航UI模块**、**菜单列表模块**、**聊天气泡模块**、**公告模块**。

| 首页模块 | 注册模块 | 登录模块 | 个人信息模块 | 聊天模块 |  默认模块 |
| --- | --- | --- | --- | --- | --- |
| /index | /register | /login | /user_info | /chat_interface | / |

#### 首页模块

用于跳转至注册和登录页面，并内嵌**导航UI模块**。

#### 注册模块

用于注册新用户，并将用户信息存储至数据库。

#### 登录模块

用于登录已有用户，并生成后续操作的 token。

#### 个人信息模块

用于展示用户的个人信息，并提供修改、注销功能。如果是他人主页，提供加好友、删除好友功能。

#### 聊天模块

主要聊天功能，几乎集成所有有关好友、群聊的功能，但功能都通过其他模块实现。内嵌**主页模块**、**菜单列表模块**。从后端拉取好友列表、群聊列表、好友请求列表、群聊申请列表，用以渲染**菜单列表模块**。

#### 默认模块

与**首页模块**一致，为所有页面提供**导航UI模块**的功能。

#### 头像模块

渲染头像，并且提供右键菜单，跳转到主页或修改分组标签。

#### 聊天窗口模块

通过**主页模块**提供的活跃会话过滤消息，渲染每条消息。提供发送消息、回复消息、删除消息的功能。通过活跃会话的群聊私聊属性渲染不同的会话窗口。为群聊管理功能提供各种函数接口，包括设置移除管理员、踢人、退群、转让群主、邀请入群等。同时提供聊天的侧栏功能，包括设置群公告、设置群头像、设置群名称、设置群头像、设置群公告等。侧栏还包括查看历史消息的接口。内嵌**聊天气泡模块**、**历史消息模块**、**公告模块**。

#### 会话选择模块

渲染会话列表，包括头像、名称、未读计数、最后一条消息等，并提供切换会话的功能。

#### 历史消息模块

从前端数据库获取当前会话的历史消息，并进行渲染，包括头像、名称、时间、消息内容等。可以根据时间、用户进行条件过滤，并可清除过滤条件。

#### 主页模块

从后端拉取聊天记录，更新本地数据库，并计算会话未读计数。记录当前选中会话，并渲染聊天窗口。内嵌**聊天窗口模块**、**会话选择模块**。

#### 导航UI模块

渲染导航栏，包括头像、用户名，提供登出与跳转至**聊天模块**的功能。导航栏还可跳转至**个人信息模块**、**首页模块**、**注册模块**、**登录模块**。并提供精确搜索用户的功能。

#### 菜单列表模块

用于渲染好友列表、群聊列表、好友请求列表、群聊申请列表，并提供相应的操作功能，包括同意、忽略好友申请，同意、拒绝群聊申请。内嵌**头像模块**。

#### 聊天气泡模块

渲染聊天气泡，包括头像、名称、消息内容、已读列表、回复计数等。根据消息属性渲染是否为回复消息，并提供删除消息的功能。

#### 公告模块

渲染公告列表，包括发表人、时间、头像、内容等。提供编辑新公告的功能。

### 后端模块

- 后端 `Account` 模块，提供用户注账号管理、用户登录和用户查找功能
- 后端 `Friendship` 模块，提供好友申请、列表拉取和好友管理功能
- 后端 `Chat` 模块，提供与消息、会话和群聊相关的功能。

#### 后端 Account 模块

- 账号管理：包括账号的注册与注销 (`register` 函数和 `delete` 函数) 和个人信息管理 (`profile` 函数拉取，`update_profile` 编辑) 功能
- 用户登录：登录并分配 `token`，用于后续操作的认证 ( `login` 函数)
- 用户查找：根据 `userId` 查找指定用户 ( `search_user`函数)

#### 后端 Friendship 模块

- 好友申请：包括好友请求的发送和接受 (`add_friend` 函数和 `accept_friend` 函数)
- 列表拉取：包括得到好友列表和好友请求列表 (`get`)
- 好友管理: 包括好友分组 (`add_tag`) 和删除好友 (`delete_friend`)

#### 后端 Chat 模块

- 消息的发送和拉取：
- 消息相关信息管理：维护详细的已读名单，删除者名单和被回复次数
- 会话的创建与拉取：
- 群聊管理
    - 成员管理：邀请用户、踢出成员和成员退群
    - 成员权限管理：转让群主、设置或移除管理员
    - 群聊信息修改：修改群名和群头像、创建群公告